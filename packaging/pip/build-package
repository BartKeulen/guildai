#!/usr/bin/env bash

set -eu

OUT_DIR=$(realpath ${1})

# Package file
cp packaging/pip/setup.py .
cp packaging/pip/README.rst .
cp packaging/pip/MANIFEST.in .

# Guild source
rm -rf guild
cp -R bazel-out/host/bin/guild/guild.runfiles/org_guildai_guild/guild guild
cp -R bazel-out/host/bin/guild/guild.runfiles/org_guildai_guild/external guild/external
cp packaging/pip/LICENSE.txt guild

#echo "### BEGIN FIND of setup dir (`pwd`)"
#find .
#echo "### END FIND"

python setup.py bdist_wheel --plat-name manylinux1_x86_64 -d "$OUT_DIR"
